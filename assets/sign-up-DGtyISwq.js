import{g as e,f as g}from"./useFetch-CPNCRhkP.js";import{c as w,a as f,B as h,A as v,S as y}from"./search-DbR8hu1i.js";import{P as b,S as E}from"./pop-up-closer-BmjNRtmD.js";import{J as M}from"./just-validate.es-C73wyOde.js";import{A}from"./add-to-bag-D7o2r1jJ.js";class C{constructor(){this.init()}async init(){const r=e("#email"),s=e("#password");if(!r||!s){console.error("Email or Password input element not found",{emailElement:r,passwordElement:s});return}const o=r.value,u=s.value;try{const n=(await w(f,o,u)).user,d={projectId:"crisp-b06bf"},c=e("#name-sign-up").value,l=e("#surname-sign-up").value,m=`https://firestore.googleapis.com/v1/projects/${d.projectId}/databases/(default)/documents/users`,p={fields:{uid:{stringValue:n.uid},name:{stringValue:c},surname:{stringValue:l},email:{stringValue:o}}},a=await g(m,{method:"POST",body:p});if(a.error){console.error("Error adding document:",a.error);return}a.data&&console.log("Document written with ID:",a.data.name),document.cookie=`UID=${n.uid}`,window.location.href="/Crisp/cabinet.html#account-dashboard"}catch(t){console.log("There was an error:",t)}}}class S{form;constructor(){this.form=e(".form"),this.form&&this.init()}init(){const r=new M(this.form,{errorLabelStyle:{color:"#1D1F21"}});r.addField(e("#name-sign-up"),[{rule:"required",errorMessage:"Enter your name"},{rule:"customRegexp",value:/^[-\w.]+$/i,errorMessage:"Write correct name"}]).addField(e("#surname-sign-up"),[{rule:"required",errorMessage:"Enter your surname"},{rule:"customRegexp",value:/^[-\w.]+$/i,errorMessage:"Write correct surname"}]).addField(e("#email"),[{rule:"required",errorMessage:"Enter your email"},{rule:"customRegexp",value:/^[-\w.]+@([а-яёa-z0-9][-A-z0-9]+\.)+[A-z]{2,4}$/,errorMessage:"Write correct email"}]).addField(e("#password"),[{rule:"required",errorMessage:"Enter your password"},{rule:"customRegexp",value:/(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])[0-9a-zA-Z!@#$%^&*]{6,}/,errorMessage:"Incorrect password format"}]).addField(e("#confirm-password"),[{rule:"required",errorMessage:"Repeat your password"},{validator:s=>{const o=document.getElementById("password").value;return s===o},errorMessage:"Passwords must match"}]),r.onSuccess(()=>{new C})}}document.addEventListener("DOMContentLoaded",async()=>{new h,new A,new v,new S,new y,new b(".buy__bag",".bag__list")});new E;
