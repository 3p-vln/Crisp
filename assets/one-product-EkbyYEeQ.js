import{a as h,g as a,L as b,f as w,r as i,B as $,A as S}from"./stop-preload-BrAlZGVA.js";import{S as y,A as B,a as D}from"./skeleton-Bgp_YBdT.js";import{P as V}from"./pagination-uIYRzJNe.js";import{L as z}from"./you-may-also-like-BJSvjOVX.js";class M{tabsBtn;tabsItems;constructor(){this.tabsBtn=h(".tabs__nav-btn"),this.tabsItems=h(".tabs__item"),this.init()}init(){this.tabsBtn.forEach(t=>{t.addEventListener("click",()=>this.onTabClick(t))})}onTabClick(t){const n=t.getAttribute("data-tab"),e=a(n);t.classList.contains("active")||(this.tabsBtn.forEach(s=>s.classList.remove("tabs__nav-btn_active")),this.tabsItems.forEach(s=>s.classList.remove("tabs__item_active")),t.classList.add("tabs__nav-btn_active"),e&&e.classList.add("tabs__item_active"))}}y.use([V,B]);const m=a(".main-img__swiper-wrapper"),f=a(".main-info__all-img");class x{swiper;slidesArr;constructor(){this.swiper=null,this.slidesArr=null,this.init().then(()=>b.stop("main-info__tabs"))}async init(){this.conectDb()}initSwiper(){if(h(".main-img__slide").length>1)this.swiper=new y(".main-img__swiper",{slidesPerView:1,autoplay:{delay:1e4},pagination:{el:".swiper-pagination"},grabCursor:!0,on:{slideChange:()=>this.onSlideChange()}}),this.initTabsSync();else{const n=a(".main-img__swiper");n&&n.classList.remove("swiper-container-initialized","swiper-container-horizontal")}}initTabsSync(){h(".tabs__nav-btn").forEach((n,e)=>{n.addEventListener("click",()=>{console.log(`Tab ${e+1} clicked`),this.swiper&&this.swiper.slideTo(e)})})}onSlideChange(){h(".tabs__nav-btn").forEach((n,e)=>{this.swiper&&e===this.swiper.realIndex?n.classList.add("tabs__nav-btn_active"):n.classList.remove("tabs__nav-btn_active")})}async conectDb(){const t=this.getDocumentIdFromURL();if(!t){console.error("Document ID not found in URL");return}const e=`https://firestore.googleapis.com/v1/projects/${{projectId:"crisp-b06bf"}.projectId}/databases/(default)/documents/clothers/${t}`,s=await w(e,{method:"GET"});if(s.error){console.error("Error fetching document:",s.error);return}s.data&&(this.slidesArr=s.data.fields,console.log(this.slidesArr),this.renderSlides(),this.initSwiper(),b.stop("main-img__slide"),b.stop("tabs__nav-btn"),new M)}getDocumentIdFromURL(){return new URLSearchParams(window.location.search).get("id")}renderSlides(){if(m&&f&&this.slidesArr){const{img:t,subImg1:n,subImg2:e,subImgWebP1:s,subImgWebP2:o}=this.slidesArr;if(t&&n&&e&&s&&o){const r=i("button",["tabs__nav-btn","tabs__nav-btn_active","skeleton"]);r.type="button",r.dataset.tab="#slide-1",r.innerHTML=`
          <img src="${t.stringValue}" />
        `;const c=i("button",["tabs__nav-btn","skeleton"]);c.type="button",c.dataset.tab="#slide-2",c.innerHTML=`
          <img src="${n.stringValue}" />
        `;const l=i("button",["tabs__nav-btn","skeleton"]);l.type="button",l.dataset.tab="#slide-3",l.innerHTML=`
          <img src="${e.stringValue}" />
        `,f.appendChild(r),f.appendChild(c),f.appendChild(l);const d=i("div",["main-img__slide","swiper-slide","tabs__item","tabs__item_active","skeleton"]);d.id="slide-1",d.innerHTML=`
          <img src="${t.stringValue}" />
        `;const u=i("div",["main-img__slide","swiper-slide","tabs__item","skeleton"]);u.id="slide-2",u.innerHTML=`
          <img src="${n.stringValue}" />
        `;const I=i("div",["main-img__slide","swiper-slide","tabs__item","skeleton"]);I.id="slide-3",I.innerHTML=`
          <img src="${e.stringValue}" />
        `,m.appendChild(d),m.appendChild(u),m.appendChild(I)}else if(t?.stringValue!=null){const r=i("button",["tabs__nav-btn","tabs__nav-btn_active","skeleton"]);r.type="button",r.dataset.tab="#slide-1",r.innerHTML=`
          <img src="${t.stringValue}" />
        `,f.appendChild(r);const c=i("div",["main-img__slide","swiper-slide","tabs__item","tabs__item_active"]);c.id="slide-1",c.innerHTML=`
          <img src="${t.stringValue}" />
        `,m.appendChild(c)}}}}class k{calculation;countElement;calculationElement;buttonCountPlus;buttonCountMinus;clotherInfo;constructor(){this.clotherInfo=null,this.calculationElement=document.getElementById("calculation"),this.countElement=document.getElementById("buttonCountNumber"),this.buttonCountPlus=document.getElementById("buttonCountPlus"),this.buttonCountMinus=document.getElementById("buttonCountMinus"),this.calculation=0,this.buttonCountPlus.onclick=this.incrementCount.bind(this),this.buttonCountMinus.onclick=this.decrementCount.bind(this),this.conectDb()}async conectDb(){const t=this.getDocumentIdFromURL();if(!t){console.error("Document ID not found in URL");return}const e=`https://firestore.googleapis.com/v1/projects/${{projectId:"crisp-b06bf"}.projectId}/databases/(default)/documents/clothers/${t}`,s=await w(e,{method:"GET"});if(s.error){console.error("Error fetching document:",s.error);return}if(s.data&&(this.clotherInfo=s.data.fields,console.log(this.clotherInfo),this.clotherInfo.cost?.stringValue)){const o=this.clotherInfo.cost.stringValue,r=parseFloat(o.replace(",","."));isNaN(r)||(this.calculation=r,this.updateCalculation(+this.countElement.innerHTML))}}getDocumentIdFromURL(){return new URLSearchParams(window.location.search).get("id")}incrementCount(){let t=+this.countElement.innerHTML;t<999&&(t++,this.countElement.innerHTML=t.toString(),this.updateCalculation(t))}decrementCount(){let t=+this.countElement.innerHTML;t>1&&(t--,this.countElement.innerHTML=t.toString(),this.updateCalculation(t))}updateCalculation(t){const n=this.calculation*t;this.calculationElement.innerHTML=this.formatPrice(n)}formatPrice(t){return t.toFixed(2).replace(".",",")}}class P{dropdownBtn;dropdownList;dropdownBtnInfo;radioButtons;constructor(t){this.dropdownBtn=a(`${t} .dropdown__btn`),this.dropdownList=a(`${t} .dropdown__list`),this.dropdownBtnInfo=this.dropdownBtn.querySelector(".dropdown__btn_info"),this.radioButtons=this.dropdownList.querySelectorAll('input[type="radio"]'),this.init()}init(){this.dropdownBtn.addEventListener("click",()=>this.toggleDropdown()),this.radioButtons.forEach(t=>t.addEventListener("change",()=>this.updateDropdown(t))),window.addEventListener("resize",()=>this.checkScreenWidth()),this.checkScreenWidth()}toggleDropdown(){this.dropdownList.classList.toggle("active"),this.dropdownBtn.classList.toggle("active")}updateDropdown(t){const n=t.parentElement;if(console.log("Radio changed:",t),console.log("Parent label:",n),n){const e=n.textContent?.trim().replace(/[\s]+$/,"")??"Size";console.log("Label text content:",e),this.dropdownBtnInfo.textContent=e}else this.dropdownBtnInfo.textContent="Size";this.dropdownList.classList.remove("active"),this.dropdownBtn.classList.remove("active")}checkScreenWidth(){window.innerWidth>1024?(this.dropdownList.classList.add("active"),this.dropdownBtn.classList.add("active")):(this.dropdownList.classList.remove("active"),this.dropdownBtn.classList.remove("active"))}}const g=a(".info__brand p"),_=a(".info__title"),C=h(".info__color-btns"),E=h(".sizes__list label"),T=a(".price__total span");class R{clotherInfo;constructor(){this.clotherInfo=null,this.init().then(()=>b.stop("main-info__info"))}async init(){this.conectDb()}async conectDb(){const t=this.getDocumentIdFromURL();if(!t){console.error("Document ID not found in URL");return}const e=`https://firestore.googleapis.com/v1/projects/${{projectId:"crisp-b06bf"}.projectId}/databases/(default)/documents/clothers/${t}`,s=await w(e,{method:"GET"});if(s.error){console.error("Error fetching document:",s.error);return}s.data&&(this.clotherInfo=s.data.fields,console.log(this.clotherInfo),this.updateUI())}getDocumentIdFromURL(){return new URLSearchParams(window.location.search).get("id")}updateUI(){this.brandAndTitle(),this.colors(),this.size(),this.price()}brandAndTitle(){g&&_&&(this.clotherInfo?(g.textContent=this.clotherInfo.brand?.stringValue||"No brand",_.textContent=this.clotherInfo.name?.stringValue||"No title",console.log(g,_)):(g.textContent="No brand",_.textContent="No title"))}colors(){this.clotherInfo?.color?.arrayValue?.values&&this.clotherInfo.color.arrayValue.values.forEach(t=>{C&&C.forEach(n=>{const e=i("div",["color",`color__${t.stringValue}`]),s=i("input",null);s.type="radio",s.name="color",s.id=t.stringValue;const o=i("div","custom-radio");e.appendChild(s),e.appendChild(o),n.appendChild(e)})})}size(){this.clotherInfo?.size?.arrayValue?.values&&(console.log("Sizes from Firestore:",this.clotherInfo.size.arrayValue.values),this.clotherInfo.size.arrayValue.values.forEach(t=>{const n=t.stringValue?.trim();n&&E&&E.forEach(e=>{e.textContent?.trim()===n&&e.classList.remove("no-size")})}))}price(){if(T&&this.clotherInfo?.cost?.stringValue){const n=this.clotherInfo.cost.stringValue.split(" ")[0];T.textContent=n}}}const L=a(".bag__add.btn.black"),v=a(".bag__list"),U=a(".pop-up__list");class H{clotherInfo;constructor(){this.clotherInfo=null,this.init()}init(){L&&L.addEventListener("click",()=>{this.conectDb()})}getDocumentIdFromURL(){return new URLSearchParams(window.location.search).get("id")}async conectDb(){const t=this.getDocumentIdFromURL();if(!t){console.error("Document ID not found in URL");return}const e=`https://firestore.googleapis.com/v1/projects/${{projectId:"crisp-b06bf"}.projectId}/databases/(default)/documents/clothers/${t}`,s=await w(e,{method:"GET"});if(s.error){console.error("Error fetching document:",s.error);return}s.data&&(this.clotherInfo={id:t,data:s.data.fields},console.log(this.clotherInfo),this.addToList())}addToList(){if(this.clotherInfo&&v){const t=`${this.clotherInfo.id} ${this.selectedSize()}`,n=!!a(`.clother.${t.split(" ").join(".")}`);if(console.log(n),v.classList.contains("active")||v.classList.add("active"),n){if(L){const e=a(`.clother.${t.split(" ").join(".")} .clother__count`)?.innerText,[s,o]=this.extractNumbers(e),r=Number(this.count()[0]),c=s+r,l=parseFloat(this.count()[1].replace(",",".")),d=o+l,u=a(`.clother.${t.split(" ").join(".")} .clother__count`);u&&(u.innerHTML=`
            ${c} x ${d},00 EUR
            `)}}else{const e=i("a",["clother",`${this.clotherInfo.id}`,`${this.selectedSize()}`]);e.href=`one-product.html?id=${this.clotherInfo.id}`;const s=i("div","clother__img");s.innerHTML=`
            <picture>
              <source srcset=${this.clotherInfo.data.imgWebP.stringValue} type="image/webp" />
              <img src=${this.clotherInfo.data.img.stringValue} />
            </picture>
        `;const o=i("div","clother__info"),r=i("p","clother__name");r.textContent=this.clotherInfo.data.name.stringValue;const c=i("p","clother__size");c.innerHTML=`Size: <span>${this.selectedSize()}</span>`;const l=i("p","clother__art");l.innerHTML=`
        Art.No.: <span>434536465<span>
        `;const d=i("p","clother__count");d.innerHTML=`
        ${this.count()[0]} x ${this.count()[1]} EUR
        `,o.appendChild(r),o.appendChild(c),o.appendChild(l),o.appendChild(d),e.appendChild(s),e.appendChild(o),U?.appendChild(e)}}}selectedSize(){const t=h(".sizes__list label"),n=[];if(t&&t.forEach(s=>{const o=s.querySelector('input[type="radio"]');o&&o.checked&&n.push(s)}),n.length==0&&this.clotherInfo?.data)return this.clotherInfo.data.size.arrayValue.values[0].stringValue;const e=n[0].textContent?.trim().replace(/[\s]+$/,"");return console.log(e),e}count(){const t=a("#buttonCountNumber")?.innerText,n=a("#calculation")?.innerText;return[t,n]}extractNumbers(t){const n=/(\d+)\s*x\s*(\d+,\d+)\s*EUR/,e=t.match(n);if(e){const s=parseInt(e[1],10),o=parseFloat(e[2].replace(",","."));return[s,o]}throw new Error("Invalid input format")}}document.addEventListener("DOMContentLoaded",async()=>{new $,new S,new x,new k,new P(".info__sizes"),new R,new z,new H,b.stop("more-info")});new D;
