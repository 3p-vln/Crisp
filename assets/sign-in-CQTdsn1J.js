import{g as o,f}from"./useFetch-CPNCRhkP.js";import{s as p,a as g,B as h,A as w,S as E}from"./search-DbR8hu1i.js";import{P as b,S as y}from"./pop-up-closer-BmjNRtmD.js";import{J as A}from"./just-validate.es-C73wyOde.js";import{A as I}from"./add-to-bag-D7o2r1jJ.js";class S{user;constructor(){this.user=[],this.init()}async init(){const r=o("#email"),t=o("#password");if(!r||!t){console.error("Email or Password input element not found",{emailElement:r,passwordElement:t});return}const c=r.value,d=t.value;try{const a={projectId:"crisp-b06bf"},u={structuredQuery:{from:[{collectionId:"users"}]}},l=`https://firestore.googleapis.com/v1/projects/${a.projectId}/databases/(default)/documents:runQuery`,s=await f(l,{method:"POST",body:u});if(s.error){console.error("Error fetching data:",s.error);return}if(s.data){s.data.forEach(e=>{if(e.document&&e.document.fields){const n=e.document.name.split("/").pop()||"";this.user.push({id:n,data:e.document.fields})}});try{const e=await p(g,c,d),n=e.user.uid;this.user.find(m=>m.data.uid.stringValue===n)?(document.cookie=`UID=${e.user.uid}`,window.location.href="/Crisp/cabinet.html#account-dashboard",console.log("User signed in and cookie set")):console.log("User not found in database")}catch(e){console.error("Error signing in:",e)}}}catch(a){console.error("Error fetching user data:",a)}}}class v{form;constructor(){this.form=o(".form"),this.form&&this.init()}init(){const r=new A(this.form,{errorLabelStyle:{color:"#1D1F21"}});r.addField(o("#email"),[{rule:"required",errorMessage:"Enter your email"},{rule:"customRegexp",value:/^[-\w.]+@([а-яёa-z0-9][-A-z0-9]+\.)+[A-z]{2,4}$/,errorMessage:"Write correct email"}]).addField(o("#password"),[{rule:"required",errorMessage:"Enter your password"},{rule:"customRegexp",value:/(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])[0-9a-zA-Z!@#$%^&*]{6,}/,errorMessage:"Incorrect password format"}]),r.onSuccess(()=>{new S})}}document.addEventListener("DOMContentLoaded",async()=>{new h,new I,new w,new v,new E,new b(".buy__bag",".bag__list")});new y;
